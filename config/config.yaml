# training
seed: 42
epochs: 1000
lr: 1e-3
viz_every: 200
out_dir: "runs/debug"

# data
image_path: "data/Chest_CT_1.png"  # grayscale PNG or JPG
normalize_to: "0_1"        # "0_1" or "-1_1"

# tcnn config
hash:
  encoding_config:
    otype: "Grid"
    type: "Hash"
    n_levels: 12
    n_features_per_level: 4
    log2_hashmap_size: 21
    base_resolution: 16
    per_level_scale: 1.5
    interpolation: "Linear"
  network_config:
    otype: "FullyFusedMLP"
    activation: "ReLU"
    output_activation: "None"
    n_neurons: 128
    n_hidden_layers: 2

# augmentation
augment:
  prob_translation: 0.2
  translation_px_max: 4

  prob_gaussian: 0.5
  gaussian_sigma: 0.02

  prob_speckle: 0.3
  speckle_sigma: 0.05

  prob_poisson: 0.3
  poisson_scale: 30.0   # photon count scaling (higher = less noise)

  prob_saltpepper: 0.1
  saltpepper_prob: 0.05 # fraction of corrupted pixels

# losses and weights
loss:
  pixel: "l1"               # "l1" or "l2"
  ssim_weight: 0.2          # requires pytorch-msssim
  lpips_weight: 0.0         # set >0 to enable; requires lpips
  ssim_window: 11

